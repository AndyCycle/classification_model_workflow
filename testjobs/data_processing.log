2024-12-19 20:27:42,846 - utils - ERROR - Error loading config: [Errno 2] No such file or directory: 'config.yaml'
2024-12-19 20:27:42,846 - __main__ - ERROR - Error in main execution: [Errno 2] No such file or directory: 'config.yaml'
Traceback (most recent call last):
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 177, in <module>
    main(args.config, args.mode)
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 74, in main
    config = Utils.load_config(config_path)
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/utils.py", line 41, in load_config
    with open(config_path, 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'config.yaml'
2024-12-19 20:39:42,758 - utils - ERROR - Error loading config: [Errno 2] No such file or directory: 'config.yaml'
2024-12-19 20:39:42,762 - __main__ - ERROR - Error in main execution: [Errno 2] No such file or directory: 'config.yaml'
Traceback (most recent call last):
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 177, in <module>
    main(args.config, args.mode)
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 74, in main
    config = Utils.load_config(config_path)
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/utils.py", line 41, in load_config
    with open(config_path, 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'config.yaml'
2024-12-19 20:46:40,875 - utils - INFO - Configuration loaded from /share/home/lsy_chenyanchao/projects/model_test/config.yaml
2024-12-19 20:46:40,884 - utils - INFO - Created experiment directory: experiments/20241219_204640
2024-12-19 20:46:40,885 - data - ERROR - Error loading data: [Errno 2] No such file or directory: 'data/breast_cancer.csv'
2024-12-19 20:46:40,885 - data - ERROR - Error setting up data module: [Errno 2] No such file or directory: 'data/breast_cancer.csv'
2024-12-19 20:46:40,885 - __main__ - ERROR - Error in main execution: [Errno 2] No such file or directory: 'data/breast_cancer.csv'
Traceback (most recent call last):
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 177, in <module>
    main(args.config, args.mode)
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 82, in main
    data_module.setup()
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/data.py", line 143, in setup
    self.dataset = CustomDataset(
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/data.py", line 50, in __init__
    self.data, self.labels = self._load_data(data_path, label_column)
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/data.py", line 70, in _load_data
    df = pd.read_csv(data_path)
  File "/share/home/lsy_chenyanchao/software/miniconda3/envs/deeplearning/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/share/home/lsy_chenyanchao/software/miniconda3/envs/deeplearning/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/share/home/lsy_chenyanchao/software/miniconda3/envs/deeplearning/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/share/home/lsy_chenyanchao/software/miniconda3/envs/deeplearning/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 1661, in _make_engine
    self.handles = get_handle(
  File "/share/home/lsy_chenyanchao/software/miniconda3/envs/deeplearning/lib/python3.8/site-packages/pandas/io/common.py", line 859, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: 'data/breast_cancer.csv'
2024-12-19 20:47:34,261 - utils - INFO - Configuration loaded from /share/home/lsy_chenyanchao/projects/model_test/config.yaml
2024-12-19 20:47:34,265 - utils - INFO - Created experiment directory: experiments/20241219_204734
2024-12-19 20:47:34,311 - data - ERROR - Error loading data: 'CustomDataset' object has no attribute 'label_encoder'
2024-12-19 20:47:34,312 - data - ERROR - Error setting up data module: 'CustomDataset' object has no attribute 'label_encoder'
2024-12-19 20:47:34,312 - __main__ - ERROR - Error in main execution: 'CustomDataset' object has no attribute 'label_encoder'
Traceback (most recent call last):
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 177, in <module>
    main(args.config, args.mode)
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 82, in main
    data_module.setup()
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/data.py", line 143, in setup
    self.dataset = CustomDataset(
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/data.py", line 50, in __init__
    self.data, self.labels = self._load_data(data_path, label_column)
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/data.py", line 81, in _load_data
    labels = self.label_encoder.fit_transform(labels)  # M=1, B=0
AttributeError: 'CustomDataset' object has no attribute 'label_encoder'
2024-12-19 20:49:13,482 - utils - INFO - Configuration loaded from /share/home/lsy_chenyanchao/projects/model_test/config.yaml
2024-12-19 20:49:13,486 - utils - INFO - Created experiment directory: experiments/20241219_204913
2024-12-19 20:49:13,501 - data - INFO - Dataset loaded with 569 samples
2024-12-19 20:49:13,533 - data - INFO - Data split completed - Train: 398, Val: 85, Test: 86
2024-12-19 20:49:13,552 - model - INFO - MLP model built successfully
2024-12-19 20:49:16,808 - train - INFO - Trainer initialized. Using device: cuda
2024-12-19 20:49:16,808 - __main__ - ERROR - Error in main execution: 'num_epochs'
Traceback (most recent call last):
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 177, in <module>
    main(args.config, args.mode)
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 94, in main
    trainer.train()
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/train.py", line 82, in train
    num_epochs = self.config['num_epochs']
KeyError: 'num_epochs'
2024-12-19 21:15:54,701 - utils - INFO - Configuration loaded from /share/home/lsy_chenyanchao/projects/model_test/config.yaml
2024-12-19 21:15:54,708 - utils - INFO - Created experiment directory: experiments/20241219_211554
2024-12-19 21:15:54,727 - data - INFO - Dataset loaded with 569 samples
2024-12-19 21:15:54,730 - data - INFO - Data split completed - Train: 398, Val: 85, Test: 86
2024-12-19 21:15:54,747 - model - INFO - MLP model built successfully
2024-12-19 21:15:57,842 - train - INFO - Trainer initialized. Using device: cuda
2024-12-19 21:15:57,842 - train - INFO - Starting training for 50 epochs
2024-12-19 21:16:02,652 - train - INFO - Train Epoch: 1 Loss: 0.6049 Acc: 64.32%
2024-12-19 21:16:02,911 - train - INFO - Validation Epoch: 1 Loss: 0.3904 Acc: 91.76%
2024-12-19 21:16:02,939 - train - INFO - Saved best model with validation accuracy: 91.76%
2024-12-19 21:16:03,239 - train - INFO - Train Epoch: 2 Loss: 0.3310 Acc: 92.21%
2024-12-19 21:16:03,475 - train - INFO - Validation Epoch: 2 Loss: 0.2182 Acc: 95.29%
2024-12-19 21:16:03,480 - train - INFO - Saved best model with validation accuracy: 95.29%
2024-12-19 21:16:03,777 - train - INFO - Train Epoch: 3 Loss: 0.2102 Acc: 93.97%
2024-12-19 21:16:04,012 - train - INFO - Validation Epoch: 3 Loss: 0.1474 Acc: 95.29%
2024-12-19 21:16:04,377 - train - INFO - Train Epoch: 4 Loss: 0.1504 Acc: 95.98%
2024-12-19 21:16:04,629 - train - INFO - Validation Epoch: 4 Loss: 0.1158 Acc: 95.29%
2024-12-19 21:16:04,934 - train - INFO - Train Epoch: 5 Loss: 0.1273 Acc: 96.23%
2024-12-19 21:16:05,168 - train - INFO - Validation Epoch: 5 Loss: 0.0981 Acc: 96.47%
2024-12-19 21:16:05,172 - train - INFO - Saved best model with validation accuracy: 96.47%
2024-12-19 21:16:05,799 - train - INFO - Train Epoch: 6 Loss: 0.1063 Acc: 95.98%
2024-12-19 21:16:06,036 - train - INFO - Validation Epoch: 6 Loss: 0.0874 Acc: 97.65%
2024-12-19 21:16:06,040 - train - INFO - Saved best model with validation accuracy: 97.65%
2024-12-19 21:16:06,406 - train - INFO - Train Epoch: 7 Loss: 0.0959 Acc: 97.24%
2024-12-19 21:16:06,659 - train - INFO - Validation Epoch: 7 Loss: 0.0792 Acc: 97.65%
2024-12-19 21:16:07,019 - train - INFO - Train Epoch: 8 Loss: 0.0862 Acc: 97.49%
2024-12-19 21:16:07,261 - train - INFO - Validation Epoch: 8 Loss: 0.0735 Acc: 97.65%
2024-12-19 21:16:07,612 - train - INFO - Train Epoch: 9 Loss: 0.0780 Acc: 97.74%
2024-12-19 21:16:07,869 - train - INFO - Validation Epoch: 9 Loss: 0.0690 Acc: 97.65%
2024-12-19 21:16:08,149 - train - INFO - Train Epoch: 10 Loss: 0.0724 Acc: 98.24%
2024-12-19 21:16:08,410 - train - INFO - Validation Epoch: 10 Loss: 0.0656 Acc: 97.65%
2024-12-19 21:16:09,131 - train - INFO - Train Epoch: 11 Loss: 0.0698 Acc: 97.99%
2024-12-19 21:16:09,389 - train - INFO - Validation Epoch: 11 Loss: 0.0626 Acc: 98.82%
2024-12-19 21:16:09,393 - train - INFO - Saved best model with validation accuracy: 98.82%
2024-12-19 21:16:09,756 - train - INFO - Train Epoch: 12 Loss: 0.0678 Acc: 97.99%
2024-12-19 21:16:10,018 - train - INFO - Validation Epoch: 12 Loss: 0.0597 Acc: 98.82%
2024-12-19 21:16:10,387 - train - INFO - Train Epoch: 13 Loss: 0.0635 Acc: 98.24%
2024-12-19 21:16:10,634 - train - INFO - Validation Epoch: 13 Loss: 0.0576 Acc: 98.82%
2024-12-19 21:16:10,919 - train - INFO - Train Epoch: 14 Loss: 0.0555 Acc: 98.74%
2024-12-19 21:16:11,175 - train - INFO - Validation Epoch: 14 Loss: 0.0559 Acc: 98.82%
2024-12-19 21:16:11,500 - train - INFO - Train Epoch: 15 Loss: 0.0519 Acc: 98.99%
2024-12-19 21:16:11,759 - train - INFO - Validation Epoch: 15 Loss: 0.0540 Acc: 98.82%
2024-12-19 21:16:12,320 - train - INFO - Train Epoch: 16 Loss: 0.0541 Acc: 99.25%
2024-12-19 21:16:12,583 - train - INFO - Validation Epoch: 16 Loss: 0.0523 Acc: 98.82%
2024-12-19 21:16:12,898 - train - INFO - Train Epoch: 17 Loss: 0.0457 Acc: 98.99%
2024-12-19 21:16:13,155 - train - INFO - Validation Epoch: 17 Loss: 0.0516 Acc: 98.82%
2024-12-19 21:16:13,478 - train - INFO - Train Epoch: 18 Loss: 0.0487 Acc: 98.99%
2024-12-19 21:16:13,736 - train - INFO - Validation Epoch: 18 Loss: 0.0501 Acc: 98.82%
2024-12-19 21:16:14,056 - train - INFO - Train Epoch: 19 Loss: 0.0486 Acc: 98.99%
2024-12-19 21:16:14,289 - train - INFO - Validation Epoch: 19 Loss: 0.0484 Acc: 98.82%
2024-12-19 21:16:14,621 - train - INFO - Train Epoch: 20 Loss: 0.0440 Acc: 98.74%
2024-12-19 21:16:14,858 - train - INFO - Validation Epoch: 20 Loss: 0.0475 Acc: 98.82%
2024-12-19 21:16:15,443 - train - INFO - Train Epoch: 21 Loss: 0.0410 Acc: 98.74%
2024-12-19 21:16:15,676 - train - INFO - Validation Epoch: 21 Loss: 0.0469 Acc: 98.82%
2024-12-19 21:16:15,676 - train - INFO - Early stopping triggered after 21 epochs
2024-12-19 21:16:15,677 - train - INFO - Training results saved to experiments/20241219_211554/training_results.json
2024-12-19 21:16:15,677 - train - INFO - Training completed
2024-12-19 21:16:15,678 - evaluate - INFO - Evaluator initialized. Using device: cuda
2024-12-19 21:16:16,372 - utils - ERROR - Error saving results: Object of type ndarray is not JSON serializable
2024-12-19 21:16:16,372 - __main__ - ERROR - Error in main execution: Object of type ndarray is not JSON serializable
Traceback (most recent call last):
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 177, in <module>
    main(args.config, args.mode)
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/main.py", line 101, in main
    Utils.save_results(results, exp_dir / 'final_results.json')
  File "/share/home/lsy_chenyanchao/projects/model_test/scr/utils.py", line 221, in save_results
    json.dump(results, f, indent=4)
  File "/share/home/lsy_chenyanchao/software/miniconda3/envs/deeplearning/lib/python3.8/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/share/home/lsy_chenyanchao/software/miniconda3/envs/deeplearning/lib/python3.8/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/share/home/lsy_chenyanchao/software/miniconda3/envs/deeplearning/lib/python3.8/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "/share/home/lsy_chenyanchao/software/miniconda3/envs/deeplearning/lib/python3.8/json/encoder.py", line 438, in _iterencode
    o = _default(o)
  File "/share/home/lsy_chenyanchao/software/miniconda3/envs/deeplearning/lib/python3.8/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
